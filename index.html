<!DOCTYPE html>

<html>
    <head>
        <meta charset="utf-8" />
        <meta name="format-detection" content="telephone=no" />
        <meta name="msapplication-tap-highlight" content="no" />
        <!-- WARNING: for iOS 7, remove the width=device-width and height=device-height attributes. See https://issues.apache.org/jira/browse/CB-4323 -->
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
        <link rel="stylesheet" type="text/css" href="css/calendar.css" />
        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css">
      	<script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
      	<script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
        <link href='https://fonts.googleapis.com/css?family=Roboto:300,400,700' rel='stylesheet' type='text/css'>
        <title> Event Calendar</title>

        <script>
        $("#cat-btn-1").click(function(){
          $("#cat-page-1").css("transform","translateX(0)");
        });

        $(document).ready(function(){
          //create table
          $tbl = $('#tblCalendar');

          $.get("js/form.json",function(data){
              console.log(data.topics);
              console.log(data.timeline);

              //creating/adding timeline headers
              $tr = $('<tr></tr>');
              $tr.css('position', 'fixed');
              $tr.append($('<th class="timeHeader" >&nbsp;</th>')); //blank
              for(var j=0; j < data.timeline.length; j++){
                $td = $('<th></th>');
                $td.attr('class' , 'timeHeader');
                $td.html(data.timeline[j].timeItemLabel);
                $tr.append($td);
              }
              $tbl.append($tr);

              //blank row
              $tr = $('<tr></tr>');
              $td = $('<th></th>');
              $td.html('&nbsp;</br>&nbsp;');
              $tr.append($td);
              $tbl.append($tr);

              //creating/adding topic rows
              for(var i=0; i < data.topics.length; i++){
                //create row
                $tr = $('<tr></tr>');

                //create topic title cell
                $td = $('<th></th>');
                $td.attr('id', 'topic' + i);
                $td.attr('class', 'topicHeader');
                $td.html(data.topics[i].topicTitle);
                $td.append('</br></br><img src="img/edit.png" alt="edit" />');
                $td.click(function(){
                  //function to go to edit screen
                });
                $tr.append($td);

                //add input cells to the topic row
                for(var j=0; j < data.timeline.length; j++){
                  $td = $('<td></td>');
                  $txtInput = $('<div></div>');
                  $txtInput.attr('class' , 'txtInput');
                  $txtInput.html(' '); //this needs to be user input stuff
                  $td.attr('id' , 'topic' + data.topics[i].topicID + '_time' + data.timeline[j].timeItemID);
                  $td.append($txtInput);
                  $td.click(function(){
                    /*$txt = $('<input>');
                    $txt.attr('type', 'text');
                    $txt.attr('id', 'txt_' + $td.attr('id'));
                    $td.append($txt);*/
                  });
                  $tr.append($td);
                }
                //add row to table
                $tbl.append($tr);
              }//end topic row loop
          });
        });

        </script>
    </head>
    <body>
        <div class="app">
          <div class="header">
      			Event Calendar
      		</div>

          <table id ="tblCalendar">
          </table>

          <div id="btnAddTopic" type="button" onclick="">Add Topic</div> 

            <div id="deviceready" class="blink">
                <p class="event listening"></p>
                <p class="event received"></p>
            </div>
        </div>
        <script type="text/javascript" src="cordova.js"></script>
        <script type="text/javascript" src="js/index.js"></script>
        <script type="text/javascript">
            app.initialize();
        </script>
    </body>
</html>
